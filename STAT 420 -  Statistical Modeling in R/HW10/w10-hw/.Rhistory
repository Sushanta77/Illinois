false_postive_aic = 0
false_negative_bic = 0
false_postive_bic = 0
rate_false_negative_aic = 0
rate_false_postive_aic = 0
rate_false_negative_bic = 0
rate_false_postive_bic = 0
for(i in 1:num_sim){
sim_data_2 = data.frame(x_1, x_2, x_3, x_4, x_5, x_6, x_7, x_8, x_9, x_10,
y = beta_0 + beta_1 * x_1 + beta_2 * x_2 + beta_3 * x_3 + beta_4 * x_4 +
beta_5 * x_5 + rnorm(n, 0 , sigma)
)
fit_add = lm(y ~ ., data = sim_data_2)
fit_add_aic_back = step(fit_add, direction = "backward", Trace=0)
false_negative_aic = false_negative_aic + sum(!(signif %in% names(coef(fit_add_aic_back)))) # which are false negatives?
false_postive_aic = false_postive_aic + sum(names(coef(fit_add_aic_back)) %in% not_sig) # which are false positives?
fit_add_bic_back = step(fit_add, direction = "backward", k = log(n), Trace=0)
false_negative_bic = false_negative_bic + sum(!(signif %in% names(coef(fit_add_bic_back)))) # which are false negatives?
false_postive_bic = false_postive_bic + sum(names(coef(fit_add_bic_back)) %in% not_sig) # which are false positives?
}
rate_false_negative_aic = false_negative_aic / num_sim
rate_false_postive_aic = false_postive_aic / num_sim
rate_false_negative_bic = false_negative_bic / num_sim
rate_false_postive_bic = false_postive_bic / num_sim
compare_aic_bic = data.frame(
Attribute = c("False Negetive","False Positve"),
AIC = c(rate_false_negative_aic,rate_false_postive_aic),
BIC = c(rate_false_negative_bic,rate_false_postive_bic)
)
kable(compare_aic_bic, format = "pandoc",padding = 2,caption = "Compare AIC BIC against False Positive, False Negetive")
data = read.csv("http://www.statsci.org/data/general/fev.txt",
quote = "\"",
comment.char = "",
stringsAsFactors = FALSE)
data
data = read.csv("http://www.statsci.org/data/general/fev.txt",sep = "\t",
quote = "\"",
comment.char = "",
stringsAsFactors = FALSE)
data
dim(data)
str(data)
pairs(data,col = "dodgerblue")
data
str(data)
data$Sex = as.factor(data$Sex)
data$Smoker = as.factor(data$Sex)
str(data)
pairs(data, col = "dodgerblue")
data$Smoker
str(data)
data = read.csv("http://www.statsci.org/data/general/fev.txt",sep = "\t",
quote = "\"",
comment.char = "",
stringsAsFactors = FALSE)
data$Sex = as.factor(data$Sex)
data$Smoker = as.factor(data$Smoker)
pairs(data, col = "dodgerblue")
model = lm(FEV~Age+Height+Sex+Smoker, data = data)
plot(predict(model)~data$FEV, col = "dodgerblue")
car::vif(model)
model = lm(log(FEV)~Age+Height+Sex+Smoker, data = data)
plot(predict(model)~data$FEV, col = "dodgerblue")
model = lm(FEV~Age+Height+Sex+Smoker+I(Age^2), data = data)
plot(predict(model)~data$FEV, col = "dodgerblue")
model1 = lm(FEV~Age+Height+Sex+Smoker, data = data)
model2 = lm(log(FEV)~Age+Height+Sex+Smoker, data = data)
model3 = lm(FEV~Age+Height+Sex+Smoker+I(Age^2), data = data)
cpar(mfrow=(1,2))
plot(predict(model1)~data$FEV, col = "dodgerblue")
plot(predict(model2)~data$FEV, col = "dodgerblue")
plot(predict(model3)~data$FEV, col = "dodgerblue")
cpar(mfrow=c(1,2))
plot(predict(model1)~data$FEV, col = "dodgerblue")
ar(mfrow=c(1,2))
par(mfrow=c(1,2))
plot(predict(model1)~data$FEV, col = "dodgerblue")
plot(predict(model2)~data$FEV, col = "dodgerblue")
plot(predict(model3)~data$FEV, col = "dodgerblue")
par(mfrow=c(2,2))
plot(predict(model1)~data$FEV, col = "dodgerblue")
plot(predict(model2)~data$FEV, col = "green")
plot(predict(model3)~data$FEV, col = "red")
model4 = lm(FEV~Age+Height+Sex+Smoker+I(Age^2)+I(Height^2), data = data)
plot(predict(model4)~data$FEV, col = "blue")
par(mfrow=c(2,2))
plot(predict(model1)~data$FEV, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lty = 2)
plot(predict(model2)~data$FEV, col = "green")
abline(a=0, b=1, col = "darkorange", lty = 2)
plot(predict(model3)~data$FEV, col = "red")
abline(a=0, b=1, col = "darkorange", lty = 2)
plot(predict(model4)~data$FEV, col = "blue")
abline(a=0, b=1, col = "darkorange", lty = 2)
plot(predict(model1)~data$FEV, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 10))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 8))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model1)~data$FEV, col = "green", xlim = c(0, 7), ylim = c(0,5))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model1)~data$FEV, col = "green", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lty = 2)
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model1)~data$FEV, col = "green", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model1)~data$FEV, col = "red", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model1)~data$FEV, col = "blue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model2)~data$FEV, col = "green", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model3)~data$FEV, col = "red", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model4)~data$FEV, col = "blue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
summary(model1)
summary(model2)
summary(model3)
summary(model4)
model5 = lm(FEV~(.)^2 + Age+Height+Sex+Smoker+I(Age^2)+I(Height^2), data = data)
plot(predict(model5)~data$FEV, col = "blue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
summary(model5)
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model3)~data$FEV, col = "green", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model4)~data$FEV, col = "red", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
par(mfrow=c(2,2))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model3)~data$FEV, col = "green", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model4)~data$FEV, col = "red", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model5)~data$FEV, col = "blue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
sqrt(mean((resid(model1) / (1 - hatvalues(model1)))^2))
sqrt(mean((resid(model1) / (1 - hatvalues(model3)))^2))
sqrt(mean((resid(model1) / (1 - hatvalues(model1)))^2))
sqrt(mean((resid(model3) / (1 - hatvalues(model3)))^2))
sqrt(mean((resid(model4) / (1 - hatvalues(model4)))^2))
sqrt(mean((resid(model5) / (1 - hatvalues(model5)))^2))
model6 = lm(FEV~(.)^3 + Age+Height+Sex+Smoker+I(Age^2)+I(Height^2), data = data)
sqrt(mean((resid(model6) / (1 - hatvalues(model6)))^2))
model5 = lm(FEV~(.)^2 + Age+Height+Sex+Smoker+I(Age^2)+I(Height^2), data = data)
summary(model5)
model6 = lm(FEV~(Age+Height+Sex+Smoker)^2 + Age+Height+Sex+Smoker+I(Age^2)+I(Height^2), data = data)
sqrt(mean((resid(model6) / (1 - hatvalues(model6)))^2))
sqrt(mean((resid(model5) / (1 - hatvalues(model5)))^2))
plot(predict(model6)~data$FEV, col = "blue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
bptest(model6)
library(lmtest)
bptest(model6)
plot(fitted(model6),resid(model6))
abline(h = 0, col = "orange")
qqnorm(resid(model6))
qqline(resid(model6))
shapiro.test(model6)
shapiro.test(resid(model6))
bptest(model1)
bptest(model2)
bptest(model3)
bptest(model4)
model6_back_aic = step(model6, direction = "backward")
sqrt(mean((resid(model6_back_aic) / (1 - hatvalues(model6_back_aic)))^2))
plot(predict(model6_back_aic)~data$FEV, col = "blue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
bptest(model6_back_aic)
shapiro.test(resid(model6_back_aic))
qqnorm(resid(model6_back_aic))
qqline(resid(model6_back_aic))
plot(fitted(model6_back_aic),resid(model6_back_aic))
abline(h = 0, col = "orange")
HistData::GaltonFamilies
library(HistData)
install.packahes("HistData")
install.packages("HistData")
HistData::GaltonFamilies
dim(GaltonFamilies)
data = HistData::GaltonFamilies
dim(data)
str(data)
?GaltonFamilies
pairs(GaltonFamilies)
pairs(data, col = "dodgerblue")
model1 = lm(childHeight~., data = data)
sqrt(mean((resid(model1) / (1 - hatvalues(model1)))^2))
model1
summary(data)
str(data)
data$family
data = read.csv("http://www.statsci.org/data/general/fev.txt",sep = "\t",
quote = "\"",
comment.char = "",
stringsAsFactors = FALSE)
dim(data)
pairs(data, col = "dodgerblue")
data
str(data)
data$Sex = as.factor(data$Sex)
data$Smoker = as.factor(data$Smoker)
pairs(data, col = "dodgerblue")
model1 = lm(FEV~Age+Height+Sex+Smoker, data = data)
model2 = lm(log(FEV)~Age+Height+Sex+Smoker, data = data)
model3 = lm(FEV~Age+Height+Sex+Smoker+I(Age^2), data = data)
model4 = lm(FEV~Age+Height+Sex+Smoker+I(Age^2)+I(Height^2), data = data)
model5 = lm(FEV~(.)^2 + Age+Height+Sex+Smoker+I(Age^2)+I(Height^2), data = data)
model6 = lm(FEV~(Age+Height+Sex+Smoker)^2 + Age+Height+Sex+Smoker+I(Age^2)+I(Height^2), data = data)
par(mfrow=c(2,2))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model3)~data$FEV, col = "green", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model4)~data$FEV, col = "red", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model5)~data$FEV, col = "blue", xlim = c(0, 7), ylim = c(0,5))
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(fitted(model6),resid(model6))
abline(h = 0, col = "orange")
plot(fitted(model6),resid(model6), col = "dodgerblue", pch = 1, cex = 1)
abline(h = 0, col = "orange", lwd = 2)
plot(fitted(model6),resid(model6), col = "dodgerblue", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2)
plot(fitted(model6),resid(model6), col = "dodgerblue", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2,lty = 2)
plot(fitted(model6),resid(model6), col = "dodgerblue", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2,lty = 2)
qqnorm(resid(model6_back_aic),col = "dodgerblue",pch = 1, cex = 1)
qqline(resid(model6_back_aic), lwd = 2, lty = 2)
plot(fitted(model6),resid(model6), col = "dodgerblue", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2,lty = 2)
plot(fitted(model6),resid(model6), col = "dodgerblue", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2,lty = 2)
plot(fitted(model6),resid(model6), col = "dodgerblue", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2,lty = 2)
qqnorm(resid(model6_back_aic),col = "dodgerblue",pch = 1, cex = 1)
qqline(resid(model6_back_aic), col = "blue" , lwd = 2, lty = 2)
plot(fitted(model6),resid(model6), col = "dodgerblue", xlab = "fitted", ylab = "residuals", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2,lty = 2)
qqnorm(resid(model6_back_aic),col = "dodgerblue",pch = 1, cex = 1)
qqline(resid(model6_back_aic), col = "blue" , lwd = 2, lty = 2)
plot(fitted(model6),resid(model6), col = "dodgerblue", xlab = "fitted", ylab = "residuals", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2,lty = 2)
qqnorm(resid(model6_back_aic),col = "dodgerblue",pch = 1, cex = 1)
qqline(resid(model6_back_aic), col = "blue" , lwd = 2, lty = 2)
bptest(model6)
shapiro.test(resid(model6))
GaltonFamilies
HistData::GaltonFamilies
str(HistData::GaltonFamilies)
model = lm(childHeight ~ father+mother+midparentHeight+children+childNum+gender, data = data)
model = lm(childHeight ~ father+mother+midparentHeight+children+childNum+gender, data = data)
data = HistData::GaltonFamilies
model = lm(childHeight ~ father+mother+midparentHeight+children+childNum+gender, data = data)
model1 = lm(childHeight ~ father+mother+midparentHeight+children+childNum+gender, data = data)
sqrt(mean((resid(model1) / (1 - hatvalues(model1)))^2))
par(mfrow=c(2,2))
plot(predict(model1)~data$FEV, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
par(mfrow=c(2,2))
plot(predict(model1)~data$childHeight, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
model1
summary(model1)
predict(model1)
data$childHeight
plot(predict(model1)~data$childHeight, col = "dodgerblue", xlim = c(0, 7), ylim = c(0,5))
plot(predict(model1)~data$childHeight, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
model2 = lm(childHeight ~ father+mother+midparentHeight+children+childNum+gender+(father+mother+midparentHeight+children+childNum+gender) ^ 2, data = data)
model2
sqrt(mean((resid(model2) / (1 - hatvalues(model2)))^2))
plot(predict(model2)~data$childHeight, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
model3 = lm(childHeight ~ father+mother+midparentHeight+children+childNum+gender+(father+mother+midparentHeight+children+childNum+gender) ^ 2 +
I(father ^ 2) + I(mother ^ 2) + I(midparentHeight ^ 2) + I(children ^ 2), data = data)
sqrt(mean((resid(model3) / (1 - hatvalues(model3)))^2))
plot(predict(model3)~data$childHeight, col = "dodgerblue")
plot(predict(model1)~data$childHeight, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model2)~data$childHeight, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model3)~data$childHeight, col = "dodgerblue")
plot(predict(model1)~data$childHeight, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model2)~data$childHeight, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(predict(model3)~data$childHeight, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
sqrt(mean((resid(model3) / (1 - hatvalues(model3)))^2))
sqrt(mean((resid(model1) / (1 - hatvalues(model1)))^2))
sqrt(mean((resid(model2) / (1 - hatvalues(model2)))^2))
plot(fitted(model3),resid(model3), col = "dodgerblue", xlab = "fitted", ylab = "residuals", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2,lty = 2)
qqnorm(resid(model3),col = "dodgerblue",pch = 1, cex = 1)
qqline(resid(model3), col = "blue" , lwd = 2, lty = 2)
shapiro.test(bptest(model3))
shapiro.test(resid(model3))
bptest(model3)
plot(predict(model3)~data$childHeight, col = "dodgerblue")
abline(a=0, b=1, col = "darkorange", lwd = 2, lty = 2)
plot(fitted(model3),resid(model3), col = "dodgerblue", xlab = "fitted", ylab = "residuals", pch = 1, cex = 1)
abline(h = 0, col = "blue", lwd = 2,lty = 2)
pairs(data[:,cfather+mother+midparentHeight+children+childNum+gender], col = "dodgerblue" )
pairs(data[:,c(father,mother,midparentHeight,children,childNum,gender)], col = "dodgerblue" )
data[:,c(father,mother,midparentHeight,children,childNum,gender)]
data
data[:,2]
data[:2]
data[,2]
data[,2:3]
pairs(data[,c(father,mother,midparentHeight,children,childNum,gender)], col = "dodgerblue" )
pairs(data[,c("father","mother","midparentHeight","children","childNum","gender")], col = "dodgerblue" )
pairs(data[,c("father","mother","midparentHeight","children","childNum","gender","childHeight")], col = "dodgerblue" )
childfev = read.csv("http://www.statsci.org/data/general/fev.txt",
sep = "\t",
quote = "\"",
comment.char = "",
stringsAsFactors = FALSE)
data$Sex = as.factor(data$Sex)
childfev = read.csv("http://www.statsci.org/data/general/fev.txt",
sep = "\t",
quote = "\"",
comment.char = "",
stringsAsFactors = FALSE)
childfev$Sex = as.factor(childfev$Sex)
childfev$Smoker = as.factor(childfev$Smoker)
str(childfev)
dim(childfev)
x=rnorm(150)
x
beta_0 = -2
beta_1 = 3
eta = beta_0 + beta_1 * x
eta
x=rnorm(25)
eta = beta_0 + beta_1 * x
eta
p = 1/(1 + exp^(-eta))
p = 1/(1 + exp(-eta))
p
rbinom(25,size = 1, p)
rbinom(1,size = 1, p)
rbern(n = 1, p)
?rbern
rbinom(1,size = 2, p)
rbinom(25,size = 2, p)
rbinom(25,size = 1, p)
rbinom(25,size = 10, p)
rbinom(25,size = 1, p)
setwd("~/Documents/GitHub/Illinois/STAT 420 -  Statistical Modeling in R/HW10/w10-hw")
install.packages("rpart.plot")
options(scipen = 1, digits = 4, width = 80, fig.align = "center")
sample_size = 150
set.seed(420)
x1 = rnorm(n = sample_size)
x2 = rnorm(n = sample_size)
x3 = rnorm(n = sample_size)
beta_0 = 0.4
beta_1 = -0.35
beta_2_hat = rep(0,2500)
liklihood_sim = rep(0,2500)
for(i in (1:2500)){
eta = beta_0 + beta_1 * x1 #simulate from this model
p = ( 1/(1+exp(-eta)) )
y = rbinom(n = sample_size, size = 1, p)
model_full = glm(y ~ x1 + x2 + x3, family = binomial)
model_1 = glm(y ~ x1, family = binomial)
model_2 = glm(y ~ x2, family = binomial)
beta_2_hat[i] = summary(model_2)$coefficient[2,'z value'] #Check beta_2 significance
liklihood_sim[i] = anova(model_1,model_full,test="LRT")[2,4]
}
beta_2_hat
head(beta_2_hat,10)
hist(beta_2_hat,
probability = TRUE,
col="darkgrey",
border="white"
)
summary(model_2)$coefficient[2,'z value']
summary(model_2)$coefficient
summary(beta_2_z_val)
eta = beta_0 + beta_1 * x1 #simulate from this model
p = ( 1/(1+exp(-eta)) )
y = rbinom(n = sample_size, size = 1, p)
model_1 = glm(y ~ x1, family = binomial)
model_2 = glm(y ~ x2, family = binomial)
summary(model_2)$coefficient
x <- seq(-4, 4, length=100)
hx <- dnorm(x)
hx
plot(hx)
line(hx)
lines(hx)
curve(hx)
curves(hx)
line(hx)
lines(hx)
lines(hx, pch = '-')
lines(hx, lwd = 2)
lines(hx, lwd = 2)
hist(beta_2_hat,
probability = TRUE,
col="darkgrey",
border="white",
name = "Histogram of beta_2 hat"
)
hist(beta_2_hat,
probability = TRUE,
col="darkgrey",
border="white",
name = "Histogram of beta_2 hat"
)
hist(beta_2_hat
)
hist(beta_2_z_val,
probability = TRUE,
col="darkgrey",
border="white",
name = "Histogram of beta_2 hat"
)
head(beta_2_z_val,10)
beta_0 = 0.4
beta_1 = -0.35
beta_2_z_val = rep(0,2500)
liklihood_sim = rep(0,2500)
for(i in (1:2500)){
eta = beta_0 + beta_1 * x1 #simulate from this model
p = ( 1/(1+exp(-eta)) )
y = rbinom(n = sample_size, size = 1, p)
model_full = glm(y ~ x1 + x2 + x3, family = binomial)
model_1 = glm(y ~ x1, family = binomial)
model_2 = glm(y ~ x2, family = binomial)
beta_2_z_val[i] = summary(model_2)$coefficient[2,'z value'] #Check beta_2 significance
liklihood_sim[i] = anova(model_1,model_full,test="LRT")[2,4]
}
head(beta_2_z_val,10)
hist(beta_2_z_val,
probability = TRUE,
col="darkgrey",
border="white",
name = "Histogram of beta_2 hat"
)
hist(beta_2_z_val)
beta_2_z_val
length(beta_2_z_val)
hist(beta_2_z_val)
hist(beta_2_z_val,
probability = TRUE)
hist(beta_2_z_val,
probability = TRUE,
col="darkgrey")
hist(beta_2_z_val,
probability = TRUE,
col="white",
border="darkgrey",
name = "Histogram of beta_2 hat"
)
hist(beta_2_z_val,
probability = TRUE,
col="white",
border="darkgrey"
)
hist(beta_2_z_val,
probability = TRUE,
col="white"
)
hist(beta_2_z_val,
probability = TRUE,
col="white",
border="grey"
)
hist(beta_2_z_val,
probability = TRUE,
col="white",
border="grey",
lwd = 2
)
hist(beta_2_z_val,
probability = TRUE,
col="white",
border="dodgerblue",
lwd = 2
)
lines(sample_data)
sample_data = dnorm(seq(-4,4,length = 1000))
lines(sample_data)
lines(sample_data,add -= TRUE)
lines(sample_data,add = TRUE)
lines(sample_data,add = Treue)
lines(sample_data,add = True)
lines(sample_data)
x <- seq(-4, 4, length=100)
hx <- dnorm(x)
x
hx
lines(hx)
lines(hx)
lines(hx,add = TRUE)
